/* SPDX-License-Identifier: GPL-2.0 WITH Linux-syscall-note */
#ifndef _UAPI_ASM_X86_SMM_H
#define _UAPI_ASM_X86_SMM_H

#define X86_SMRAM_SIZE				512

/* KVMs 32 bit SMRAM layout is based of Intels SDM (Vol 3 Section 34.4.1) */
#define X86_SMRAM_32_CR0			0x7ffc
#define X86_SMRAM_32_CR3			0x7ff8
#define X86_SMRAM_32_EFLAGS			0x7ff4
#define X86_SMRAM_32_EIP			0x7ff0
#define X86_SMRAM_32_EDI			0x7fec
#define X86_SMRAM_32_ESI			0x7fe8
#define X86_SMRAM_32_EBP			0x7fe4
#define X86_SMRAM_32_ESP			0x7fe0
#define X86_SMRAM_32_EBX			0x7fdc
#define X86_SMRAM_32_EDX			0x7fd8
#define X86_SMRAM_32_ECX			0x7fd4
#define X86_SMRAM_32_EAX			0x7fd0
#define X86_SMRAM_32_DR6			0x7fcc
#define X86_SMRAM_32_DR7			0x7fc8
#define X86_SMRAM_32_TR				0x7fc4
#define X86_SMRAM_32_GS				0x7fbc
#define X86_SMRAM_32_FS				0x7fb8
#define X86_SMRAM_32_DS				0x7fb4
#define X86_SMRAM_32_SS				0x7fb0
#define X86_SMRAM_32_CS				0x7fac
#define X86_SMRAM_32_ES				0x7fa8
#define X86_SMRAM_32_IO_STATE			0x7fa4
#define X86_SMRAM_32_IO_MEM			0x7fa0
#define X86_SMRAM_32_AUTO_HALT_RESTART		0x7f02
#define X86_SMRAM_32_IO_INST_RESTART		0x7f00
#define X86_SMRAM_32_SMM_REV			0x7efc
#define X86_SMRAM_32_SMBASE			0x7ef8
#define X86_SMRAM_32_TR_SELECTOR		X86_SMRAM_32_TR
#define X86_SMRAM_32_TR_BASE			0x7f64
#define X86_SMRAM_32_TR_LIMIT			0x7f60
#define X86_SMRAM_32_TR_FLAGS			0x7f5c
#define X86_SMRAM_32_LDTR_SELECTOR		0x7fc0
#define X86_SMRAM_32_LDTR_BASE			0x7f80
#define X86_SMRAM_32_LDTR_LIMIT			0x7f7c
#define X86_SMRAM_32_LDTR_FLAGS			0x7f78
#define X86_SMRAM_32_ES_BASE			0x7f84
#define X86_SMRAM_32_DS_BASE			0x7f2c
#define X86_SMRAM_32_GDT_ADDR			0x7f74
#define X86_SMRAM_32_GDT_SIZE			0x7f70
#define X86_SMRAM_32_IDT_ADDR			0x7f58
#define X86_SMRAM_32_IDT_SIZE			0x7f54
#define X86_SMRAM_32_CR4			0x7f14

/* KVMs 64 bit SMRAM layout is based of AMDs SMD (Vol 2 Section 10.2.3) */
#define X86_SMRAM_64_GDTR_LIMIT			0x7e64
#define X86_SMRAM_64_GDTR_BASE			0x7e68
#define X86_SMRAM_64_LDTR_SELECTOR		0x7e70
#define X86_SMRAM_64_LDTR_ATTR			0x7e72
#define X86_SMRAM_64_LDTR_LIMIT			0x7e74
#define X86_SMRAM_64_LDTR_BASE			0x7e78
#define X86_SMRAM_64_IDTR_LIMIT			0x7e84
#define X86_SMRAM_64_IDTR_BASE			0x7e88
#define X86_SMRAM_64_TR_SELECTOR		0x7e90
#define X86_SMRAM_64_TR_ATTR			0x7e92
#define X86_SMRAM_64_TR_LIMIT			0x7e94
#define X86_SMRAM_64_TR_BASE			0x7e98
#define X86_SMRAM_64_IO_INST_RESTART_RIP	0x7ea0
#define X86_SMRAM_64_IO_INST_RESTART_RCX	0x7ea8
#define X86_SMRAM_64_IO_INST_RESTART_RSI	0x7eb0
#define X86_SMRAM_64_IO_INST_RESTART_RDI	0x7eb8
#define X86_SMRAM_64_IO_INST_RESTART_DWORD	0x7ec0
#define X86_SMRAM_64_IO_INST_RESTART		0x7ec8
#define X86_SMRAM_64_AUTO_HALT_RESTART		0x7ec9
#define X86_SMRAM_64_EFER			0x7ed0
#define X86_SMRAM_64_SVM_GUEST			0x7ed8
#define X86_SMRAM_64_SVM_GUEST_VMCB		0x7ee0
#define X86_SMRAM_64_SVM_GUEST_VINT		0x7ee8
#define X86_SMRAM_64_SMM_REV			0x7efc
#define X86_SMRAM_64_SMBASE			0x7f00
#define X86_SMRAM_64_SVM_GUEST_PAT		(X86_SMRAM_64_RAX - 27 * 8)
#define X86_SMRAM_64_SVM_HOST_EFER		(X86_SMRAM_64_RAX - 26 * 8)
#define X86_SMRAM_64_SVM_HOST_CR4		(X86_SMRAM_64_RAX - 25 * 8)
#define X86_SMRAM_64_SVM_HOST_CR3		(X86_SMRAM_64_RAX - 24 * 8)
#define X86_SMRAM_64_SVM_HOST_CR0		(X86_SMRAM_64_RAX - 23 * 8)
#define X86_SMRAM_64_CR4			(X86_SMRAM_64_RAX - 22 * 8)
#define X86_SMRAM_64_CR3			(X86_SMRAM_64_RAX - 21 * 8)
#define X86_SMRAM_64_CR0			(X86_SMRAM_64_RAX - 20 * 8)
#define X86_SMRAM_64_DR7			(X86_SMRAM_64_RAX - 19 * 8)
#define X86_SMRAM_64_DR6			(X86_SMRAM_64_RAX - 18 * 8)
#define X86_SMRAM_64_RFLAGS			(X86_SMRAM_64_RAX - 17 * 8)
#define X86_SMRAM_64_RIP			(X86_SMRAM_64_RAX - 16 * 8)
#define X86_SMRAM_64_R15			(X86_SMRAM_64_RAX - 15 * 8)
#define X86_SMRAM_64_R14			(X86_SMRAM_64_RAX - 14 * 8)
#define X86_SMRAM_64_R13			(X86_SMRAM_64_RAX - 13 * 8)
#define X86_SMRAM_64_R12			(X86_SMRAM_64_RAX - 12 * 8)
#define X86_SMRAM_64_R11			(X86_SMRAM_64_RAX - 11 * 8)
#define X86_SMRAM_64_R10			(X86_SMRAM_64_RAX - 10 * 8)
#define X86_SMRAM_64_R9				(X86_SMRAM_64_RAX - 9 * 8)
#define X86_SMRAM_64_R8				(X86_SMRAM_64_RAX - 8 * 8)
#define X86_SMRAM_64_RDI			(X86_SMRAM_64_RAX - 7 * 8)
#define X86_SMRAM_64_RSI			(X86_SMRAM_64_RAX - 6 * 8)
#define X86_SMRAM_64_RBP			(X86_SMRAM_64_RAX - 5 * 8)
#define X86_SMRAM_64_RSP			(X86_SMRAM_64_RAX - 4 * 8)
#define X86_SMRAM_64_RBX			(X86_SMRAM_64_RAX - 3 * 8)
#define X86_SMRAM_64_RDX			(X86_SMRAM_64_RAX - 2 * 8)
#define X86_SMRAM_64_RCX			(X86_SMRAM_64_RAX - 1 * 8)
#define X86_SMRAM_64_RAX			0x7ff8

#endif /* _UAPI_ASM_X86_SMM_H */
